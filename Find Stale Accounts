# Find users not logged in for at least 30 days and export the list to a usable document.

Establish variables:

$InactiveDays = 30
$Days = (Get-Date).Adddays(-($InactiveDays))

# Find AD Users whose lastlogonTimestamp property was greater than 30 days and user status is enabled in active directory, then pipe those results 
# to the second command to select Name, LastLogonDate of users and export users not logged in last 30 days to CSV file using Export-Csv cmdlet:

Get-ADUser -Filter {LastLogonTimeStamp -lt $Days -and enabled -eq $true} -Properties LastLogonTimeStamp |
select-object Name,@{Name="Date"; Expression={[DateTime]::FromFileTime($_.lastLogonTimestamp).ToString('MM-dd-yyyy')}} | 
export-csv C:\LastLogOn_Users.csv -notypeinformation
